LogFormat "%T %D %V %a %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-agent}i\"" combined
CustomLog /dev/stdout combined
ErrorLogFormat "%V %a [%t] [%l] [pid %P] [%F] [%E] %M"
ErrorLog /dev/stderr
LogLevel warn

RemoteIPHeader X-Forwarded-For
RemoteIPInternalProxy 10.180.21.232
RemoteIPInternalProxy 10.180.21.233
RemoteIPInternalProxy 10.180.21.244
RemoteIPInternalProxy 172.31.0.0/16

ScriptSock /home/dinfo/cgisock

<VirtualHost *:8080>
  ServerName payonline.epfl.ch

  ## Vhost docroot
  DocumentRoot "/var/www/vhosts/payonline.epfl.ch/htdocs"

  SetEnv SITE_URL ${SITE_URL}
  SetEnv TEQUILA_HOST ${TEQUILA_HOST}
  SetEnv TEQUILA_FINGERPRINT '${TEQUILA_FINGERPRINT}'
  SetEnv MOCK_ORACLE ${MOCK_ORACLE}
  SetEnv POD_NAME ${POD_NAME}
  SetEnv E2EM_LINE ${E2EM_LINE}

  ## Directories, there should at least be a declaration for /var/www/vhosts/payonline.epfl.ch/htdocs
  <Directory "/var/www/vhosts/payonline.epfl.ch/cgi-bin/">
    Options +ExecCGI
    AddHandler cgi-script .cgi
    SetEnv PERL5LIB /opt/dinfo/lib/perl
  </Directory>

  ## Load additional static includes
  Include "/var/www/vhosts/payonline.epfl.ch/conf/*.conf"

  ServerSignature Off

  ## Script alias directives
  ScriptAlias /cgi-bin/ "/var/www/vhosts/payonline.epfl.ch/cgi-bin/"

  ## Server aliases
  ServerAlias payonline
  ServerAlias test-payonline.epfl.ch
  ServerAlias test-payonline
  ServerAlias payonline01.epfl.ch
  ServerAlias payonline01
</VirtualHost>
